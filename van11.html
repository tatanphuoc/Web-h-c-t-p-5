<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üìò Ng·ªØ vƒÉn 11</title>
<style>
  :root {
    --bg: #0e1726;
    --card: #1a1622;
    --accent1: #f39c12;
    --accent2: #9b59b6;
    --text: #e6eef8;
    --muted: #94a3b8;
  }
  body {
    margin: 0;
    font-family: "Poppins", sans-serif;
    background: var(--bg);
    color: var(--text);
    padding: 20px;
    text-align: center;
  }
  h1 { color: var(--accent2); }
  .chapter, .lesson, .content { display: none; }
  .active { display: block; }
  .card {
    background: var(--card);
    padding: 16px;
    border-radius: 12px;
    margin: 10px auto;
    max-width: 500px;
    cursor: pointer;
    transition: 0.3s;
  }
  .card:hover { transform: scale(1.03); border: 1px solid var(--accent1); }
  .btn {
    background: var(--accent1);
    color: var(--bg);
    padding: 8px 16px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    margin: 5px;
  }
  iframe {
    width: 100%; height: 360px; border: none; border-radius: 8px; margin-top: 10px;
  }
  .question {
    background: var(--card);
    margin: 10px auto;
    padding: 10px;
    border-radius: 10px;
    max-width: 600px;
    text-align: left;
  }
  .option label{ cursor:pointer; }
  .option input{ margin-right:8px; }
  .option {
    display: block;
    background: #241827;
    margin: 6px 0;
    padding: 8px;
    border-radius: 8px;
    transition: 0.2s;
  }
  .option:hover { background: var(--accent2); color: var(--bg); }
  .back {
    display: block;
    margin: 20px auto;
    color: var(--accent2);
    cursor: pointer;
  }
  input[type=text]{
    width:90%; padding:8px; border-radius:6px; border:1px solid #332437; background:#0b0610; color:var(--text);
  }
  .result {
    margin: 20px auto;
    color: var(--accent1);
  }
  .answer{ margin-top:8px; color:var(--accent1); }
</style>
</head>
<body>

<h1>üìò Ng·ªØ vƒÉn 11</h1>
<p>Ch·ªçn ch∆∞∆°ng ƒë·ªÉ b·∫Øt ƒë·∫ßu h·ªçc</p>

<div id="chapters"></div>
<div id="lessons" class="chapter"></div>
<div id="lessonDetail" class="lesson"></div>
<div id="content" class="content"></div>

<script>
// ------------------ √Çm thanh WebAudio ------------------
let audioCtx = new (window.AudioContext || window.webkitAudioContext)();
function playClick(){
  const osc = audioCtx.createOscillator();
  const gain = audioCtx.createGain();
  osc.connect(gain);
  gain.connect(audioCtx.destination);
  osc.frequency.value = 400;
  gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
  osc.start();
  osc.stop(audioCtx.currentTime + 0.1);
}

// ------------------ D·ªØ li·ªáu ------------------
const data = [
  { title: "B√†i 1: Th∆° v√† truy·ªán th∆°", lessons: ["S√≥ng (Xu√¢n Qu·ª≥nh)", "L·ªùi ti·ªÖn d·∫∑n (Tr√≠ch)", "Th·ª±c h√†nh ƒë·ªçc hi·ªÉu v√† bi·ªÉu ƒë·∫°t"] },
  { title: "B√†i 2: Th∆° Nguy·ªÖn Du", lessons: ["Nguy·ªÖn Du - Cu·ªôc ƒë·ªùi v√† s·ª± nghi·ªáp", "Trao duy√™n (Tr√≠ch Truy·ªán Ki·ªÅu)", "Ti·ªÉu Thanh k√≠"] },
  { title: "B√†i 3: Truy·ªán", lessons: ["Ch√≠ Ph√®o (Nam Cao)", "Ch·ªØ ng∆∞·ªùi t·ª≠ t√π (Nguy·ªÖn Tu√¢n)", "Th·ª±c h√†nh ƒë·ªçc hi·ªÉu truy·ªán"] },
  { title: "B√†i 4: VƒÉn b·∫£n th√¥ng tin", lessons: ["Ph·∫£i coi lu·∫≠t ph√°p nh∆∞ khi tr·ªùi ƒë·ªÉ th·ªü", "T·∫° Quang B·ª≠u - ng∆∞·ªùi th·∫ßy th√¥ng th√°i", "Th·ª±c h√†nh ƒë·ªçc hi·ªÉu VB th√¥ng tin"] },
  { title: "B√†i 5: Truy·ªán ng·∫Øn", lessons: ["Tr√°i tim ƒêan-k√¥", "M·ªôt ng∆∞·ªùi H√† N·ªôi", "T·∫ßng hai (Phong ƒêi·ªáp)"] }
];

// ------------------ C√¢u h·ªèi m·∫´u ------------------
const quiz = {};
function makeFive(lesson){
  return [
    { q: `C√¢u 1: N·ªôi dung ch√≠nh c·ªßa "${lesson}" l√† g√¨?`, a: "ƒê·ªçc hi·ªÉu v√† ph√¢n t√≠ch n·ªôi dung, ngh·ªá thu·∫≠t", opts: ["ƒê·ªçc hi·ªÉu v√† ph√¢n t√≠ch n·ªôi dung, ngh·ªá thu·∫≠t", "Th·ª±c h√†nh th√≠ nghi·ªám", "T√≠nh to√°n s·ªë li·ªáu", "Kh√¥ng li√™n quan"] },
    { q: `C√¢u 2: Khi h·ªçc b√†i "${lesson}" c·∫ßn ch√∫ √Ω ƒëi·ªÅu g√¨?`, a: "Ng√¥n ng·ªØ, ngh·ªá thu·∫≠t, b·ªëi c·∫£nh", opts: ["Ng√¥n ng·ªØ, ngh·ªá thu·∫≠t, b·ªëi c·∫£nh", "Th·ªùi ti·∫øt", "C√¥ng th·ª©c h√≥a h·ªçc", "B·∫£n ƒë·ªì ƒë·ªãa l√Ω"] },
    { q: `C√¢u 3: Khi vi·∫øt ƒëo·∫°n vƒÉn c·∫£m nh·∫≠n c·∫ßn:`, a: "Lu·∫≠n ƒëi·ªÉm r√µ, d·∫´n ch·ª©ng, li√™n h·ªá", opts: ["Lu·∫≠n ƒëi·ªÉm r√µ, d·∫´n ch·ª©ng, li√™n h·ªá", "Vi·∫øt ng·∫´u h·ª©ng", "Ch·ªâ ch√©p nguy√™n vƒÉn", "Kh√¥ng c·∫ßn d·∫´n ch·ª©ng"] },
    { q: `C√¢u 4: Kƒ© nƒÉng c·∫ßn thi·∫øt khi h·ªçc b√†i n√†y l√†:`, a: "ƒê·ªçc hi·ªÉu, ph√¢n t√≠ch, di·ªÖn ƒë·∫°t", opts: ["ƒê·ªçc hi·ªÉu, ph√¢n t√≠ch, di·ªÖn ƒë·∫°t", "Th·ª±c h√†nh h√≥a th√≠", "T√≠nh to√°n s·ªë li·ªáu", "L·∫≠p tr√¨nh"] },
    { q: `C√¢u 5: B√†i n√†y gi√∫p r√®n luy·ªán ƒëi·ªÅu g√¨?`, a: "T∆∞ duy c·∫£m th·ª• vƒÉn h·ªçc v√† di·ªÖn ƒë·∫°t", opts: ["T∆∞ duy c·∫£m th·ª• vƒÉn h·ªçc v√† di·ªÖn ƒë·∫°t", "Ghi nh·ªõ m√°y m√≥c", "L√†m th√≠ nghi·ªám", "Quan s√°t thi√™n nhi√™n"] }
  ];
}
for(let ci=0; ci<data.length; ci++){
  quiz[ci+1] = {};
  for(let li=0; li<data[ci].lessons.length; li++){
    quiz[ci+1][li+1] = makeFive(data[ci].lessons[li]);
  }
}

// ------------------ Giao di·ªán ------------------
const chaptersDiv = document.getElementById("chapters");
const lessonsDiv = document.getElementById("lessons");
const lessonDetail = document.getElementById("lessonDetail");
const contentDiv = document.getElementById("content");
let lastOpened = { ch: null, lesson: null };

data.forEach((ch,i)=>{
  const div=document.createElement("div");
  div.className="card";
  div.textContent=ch.title;
  div.onclick=()=>{playClick();openChapter(i+1)};
  chaptersDiv.appendChild(div);
});

function openChapter(id){
  playClick();
  chaptersDiv.style.display="none";
  lessonsDiv.classList.add("active");
  lessonsDiv.innerHTML=`<h2>${data[id-1].title}</h2>`;
  data[id-1].lessons.forEach((b,i)=>{
    const card=document.createElement("div");
    card.className="card";
    card.textContent=b;
    card.onclick=()=>{playClick();openLesson(id,i+1)};
    lessonsDiv.appendChild(card);
  });
  const back=document.createElement("div");
  back.className="back";
  back.textContent="‚Üê Quay l·∫°i danh s√°ch ch∆∞∆°ng";
  back.onclick=()=>{playClick();lessonsDiv.classList.remove("active");chaptersDiv.style.display="block";};
  lessonsDiv.appendChild(back);
}

function openLesson(ch,b){
  playClick();
  lastOpened={ch:ch,lesson:b};
  lessonsDiv.classList.remove("active");
  lessonDetail.classList.add("active");
  const title=data[ch-1].lessons[b-1];
  lessonDetail.innerHTML=`
    <h2>${title}</h2>
    <button class="btn" onclick="playClick();showTheory(${ch},${b})">üìñ L√Ω thuy·∫øt</button>
    <button class="btn" onclick="playClick();showQuiz(${ch})">üìù B√†i t·∫≠p tr·∫Øc nghi·ªám</button>
    <button class="btn" onclick="playClick();showStorage(${ch},${b})">üíæ L∆∞u tr·ªØ t√†i li·ªáu</button>
    <div class="back" onclick="playClick();backToLessons(${ch})">‚Üê Quay l·∫°i danh s√°ch b√†i</div>`;
}

// ------------------ L√Ω thuy·∫øt ------------------
function showTheory(ch,b){
  lessonDetail.classList.remove("active");
  contentDiv.classList.add("active");
  contentDiv.innerHTML=`
    <h2>${data[ch-1].lessons[b-1]} - L√Ω thuy·∫øt</h2>
    <input type="text" id="link" placeholder="D√°n link YouTube ho·∫∑c trang web...">
    <button class="btn" onclick="playClick();loadVideo()">Hi·ªÉn th·ªã</button>
    <div id="videoArea"></div>
    <div class="back" onclick="playClick();backToLesson(${ch},${b})">‚Üê Quay l·∫°i</div>`;
}

function loadVideo(){
  const link=document.getElementById("link").value;
  const videoArea=document.getElementById("videoArea");
  if(link.includes("youtube")||link.includes("youtu.be")){
    let id='';
    if(link.includes('v=')) id=link.split('v=')[1].split('&')[0];
    else if(link.includes('youtu.be/')) id=link.split('youtu.be/')[1].split('?')[0];
    videoArea.innerHTML=`<iframe src="https://www.youtube.com/embed/${id}" allowfullscreen></iframe>`;
  } else {
    if(!link) videoArea.innerHTML='<p style="color:var(--muted)">Ch∆∞a c√≥ link.</p>';
    else videoArea.innerHTML=`<a href="${link}" target="_blank" style="color:var(--accent2)">M·ªü t√†i li·ªáu t·∫°i ƒë√¢y</a>`;
  }
}

// ------------------ B√†i t·∫≠p ------------------
function showQuiz(ch){
  lessonDetail.classList.remove("active");
  contentDiv.classList.add("active");
  const lessonIndex=lastOpened.lesson;
  const qList=(quiz[ch]&&quiz[ch][lessonIndex])||[];
  if(qList.length===0){
    contentDiv.innerHTML=`<h2>B√†i t·∫≠p tr·∫Øc nghi·ªám</h2><p style='color:var(--muted)'>Ch∆∞a c√≥ c√¢u h·ªèi.</p><div class='back' onclick='backToLesson(${ch},${lessonIndex})'>‚Üê Quay l·∫°i</div>`;
    return;
  }
  let html=`<h2>B√†i t·∫≠p tr·∫Øc nghi·ªám: ${data[ch-1].lessons[lessonIndex-1]}</h2>`;
  qList.forEach((q,i)=>{
    html+=`<div class='question' id='q${i}'><strong>${i+1}. ${q.q}</strong><br>`;
    q.opts.forEach(opt=>{
      html+=`<div class="option"><label><input type='radio' name='q${i}' value='${opt}'> ${opt}</label></div>`;
    });
    html+=`</div>`;
  });
  html+=`<button class='btn' onclick='playClick();submitQuiz(${ch},${lessonIndex})'>Ki·ªÉm tra k·∫øt qu·∫£</button><div id='result' class='result'></div><div class='back' onclick='playClick();backToLesson(${ch},${lessonIndex})'>‚Üê Quay l·∫°i</div>`;
  contentDiv.innerHTML=html;
}

function submitQuiz(ch,lessonIndex){
  const qList=quiz[ch][lessonIndex];
  let correct=0;
  qList.forEach((q,i)=>{
    const selected=document.querySelector(`input[name='q${i}']:checked`);
    const questionDiv=document.getElementById(`q${i}`);
    const oldAns=questionDiv.querySelector('.answer');
    if(oldAns) oldAns.remove();
    if(selected&&selected.value===q.a) correct++;
    else {
      const ans=document.createElement('div');
      ans.className='answer';
      ans.textContent=`ƒê√°p √°n ƒë√∫ng: ${q.a}`;
      questionDiv.appendChild(ans);
    }
  });
  const total=qList.length;
  const resultDiv=document.getElementById('result');
  resultDiv.textContent=`K·∫øt qu·∫£: ${correct}/${total} c√¢u ƒë√∫ng`;
  const retry=document.createElement('button');
  retry.className='btn';
  retry.textContent='L√†m l·∫°i';
  retry.onclick=()=>{playClick();showQuiz(ch)};
  resultDiv.appendChild(document.createElement('br'));
  resultDiv.appendChild(retry);
  window.scrollTo({top:0,behavior:'smooth'});
}

// ------------------ L∆∞u tr·ªØ ------------------
function showStorage(ch,b){
  lessonDetail.classList.remove("active");
  contentDiv.classList.add("active");
  const key=`van11_storage_${ch}_${b}`;
  let files=JSON.parse(localStorage.getItem(key)||"[]");
  contentDiv.innerHTML=`
    <h2>üíæ L∆∞u tr·ªØ t√†i li·ªáu - ${data[ch-1].lessons[b-1]}</h2>
    <input type="file" id="storeInput" multiple>
    <button class="btn" id="clearAllBtn">üóë X√≥a t·∫•t c·∫£</button>
    <div id="fileList"></div>
    <div class="back" onclick="playClick();backToLesson(${ch},${b})">‚Üê Quay l·∫°i</div>`;
  const fileList=document.getElementById("fileList");
  function renderList(){
    fileList.innerHTML="";
    if(!files.length){
      fileList.innerHTML="<p style='color:var(--muted)'>Ch∆∞a c√≥ t√†i li·ªáu n√†o.</p>";
      return;
    }
    files.forEach((f,i)=>{
      const div=document.createElement("div");
      div.className="question";
      div.innerHTML=`<strong>${f.name}</strong> (${Math.round(f.size/1024)} KB)
      <div style='margin-top:8px'>
        <button class='btn' onclick="window.open('${f.url}')">Xem</button>
        <button class='btn' onclick='deleteFile(${i})'>X√≥a</button>
      </div>`;
      fileList.appendChild(div);
    });
  }
  window.deleteFile=(i)=>{files.splice(i,1);localStorage.setItem(key,JSON.stringify(files));renderList();};
  document.getElementById("storeInput").addEventListener("change",(e)=>{
    const arr=[...e.target.files];
    arr.forEach(f=>{
      const url=URL.createObjectURL(f);
      files.push({name:f.name,size:f.size,url});
    });
    localStorage.setItem(key,JSON.stringify(files));
    renderList();
  });
  document.getElementById("clearAllBtn").addEventListener("click",()=>{
    if(confirm("X√≥a to√†n b·ªô t√†i li·ªáu?")){
      localStorage.removeItem(key);
      files=[];
      renderList();
    }
  });
  renderList();
}

// ------------------ ƒêi·ªÅu h∆∞·ªõng ------------------
function backToLessons(ch){playClick();lessonDetail.classList.remove("active");openChapter(ch);}
function backToLesson(ch,b){playClick();contentDiv.classList.remove("active");openLesson(ch,b);}
</script>
<!-- N√∫t quay l·∫°i trang ch√≠nh -->
<div style="margin-top:30px;">
  <button class="btn" onclick="window.location.href='index.html'">
    ‚Üê Quay l·∫°i trang ch√≠nh
 </button>
</body>
</html>

